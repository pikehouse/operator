# Requirements Archive: v3.0 Operator Laboratory

**Archived:** 2026-01-28
**Status:** SHIPPED

This is the archived requirements specification for v3.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## Overview

v3.0 requirements were defined inline in ROADMAP.md as success criteria for each phase. This milestone pivoted from the v2.3 action framework approach to a simpler "give Claude a shell and let it figure things out" philosophy.

## Requirements (from ROADMAP.md Phase Success Criteria)

### Phase 30: Core Agent

- [x] **CORE-01**: Agent container builds and runs with Docker socket access
- [x] **CORE-02**: shell() tool logs to audit format before and after execution
- [x] **CORE-03**: shell() can execute arbitrary commands with 120s timeout
- [x] **CORE-04**: SessionAuditor saves complete conversation history to JSON

### Phase 31: Agent Loop

- [x] **LOOP-01**: Agent polls database for open tickets every 1 second
- [x] **LOOP-02**: Claude receives ticket and can call shell tool
- [x] **LOOP-03**: Tool results summarized by Haiku before logging
- [x] **LOOP-04**: Complete audit trail stored in database
- [x] **LOOP-05**: Core loop is < 200 lines

### Phase 32: Integration & Demo

- [x] **INTG-01**: Agent container runs alongside TiKV cluster in Docker Compose
- [x] **INTG-02**: Claude autonomously diagnoses TiKV failure (no predefined playbook)
- [x] **INTG-03**: Claude fixes issue using shell commands (docker restart, etc.)
- [x] **INTG-04**: Complete audit log shows reasoning chain
- [x] **INTG-05**: Environment recoverable via docker-compose down/up

---

## Traceability

| Requirement | Phase | Status | Evidence |
|-------------|-------|--------|----------|
| CORE-01 | 30 | Complete | Dockerfile builds (51 lines) |
| CORE-02 | 30 | Complete | Integration point via log_tool_call() |
| CORE-03 | 30 | Complete | asyncio.wait_for with 120s timeout |
| CORE-04 | 30 | Complete | save_session() writes JSON |
| LOOP-01 | 31 | Complete | time.sleep(1) polling |
| LOOP-02 | 31 | Complete | @beta_tool decorator, tools=[shell] |
| LOOP-03 | 31 | Complete | claude-haiku-4-5-20250929 |
| LOOP-04 | 31 | Complete | reasoning + tool_call + tool_result entries |
| LOOP-05 | 31 | Complete | 198 lines |
| INTG-01 | 32 | Complete | tikv_default external network |
| INTG-02 | 32 | Complete | 68 audit entries, no playbook |
| INTG-03 | 32 | Complete | docker start tikv0 in audit |
| INTG-04 | 32 | Complete | Full reasoning chain verified |
| INTG-05 | 32 | Complete | Human verification checkpoint |

**Coverage:** 14/14 requirements satisfied (100%)

---

## Milestone Summary

**Shipped:** 14 of 14 requirements

**Philosophy validated:**
- "Let Claude cook" approach works for autonomous operation
- Container isolation provides sufficient safety boundary
- Complete audit trail enables post-hoc review
- No predefined playbooks needed for common SRE tasks

**Adjusted:** None â€” requirements executed as planned

**Dropped:** None

---

*Archived: 2026-01-28 as part of v3.0 milestone completion*
