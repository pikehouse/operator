# v2.3 Infrastructure Actions & Script Execution (Archived)

**Status:** Archived incomplete — superseded by v3.0 Operator Laboratory
**Archived:** 2026-01-28

## Summary

7 phases planned, 4 completed, 3 superseded.

**Completed phases:**
- Phase 23: Safety Enhancement (4 plans)
- Phase 24: Docker Actions (3 plans)
- Phase 25: Host Actions (3 plans)
- Phase 26: Script Execution & Validation (3 plans)

**Superseded phases:**
- Phase 27: Risk Classification
- Phase 28: Agent Integration
- Phase 29: Demo Scenarios

## Reason for Archive

Philosophy pivot. v2.3 built an elaborate action framework with:
- Dedicated executors (DockerActionExecutor, HostActionExecutor, ScriptExecutor)
- Approval workflows with TOCTOU protection
- Risk classification and approval modes
- Parameter validation and schema definitions

v3.0 "Operator Laboratory" replaces this with a simpler approach:
- Three tools: shell, web_search, web_fetch
- Safety via container isolation, not action restrictions
- Audit everything, approve nothing
- Let Claude figure out what commands to run

## Completed Work (Phases 23-26)

### Phase 23: Safety Enhancement

**Goal:** Enhanced safety controls for TOCTOU races, agent identity, and multi-step attacks.

**Deliverables:**
- Identity & dual authorization (requester_id, agent_id fields)
- Secret redaction in audit logs
- TOCTOU-resistant approval workflow with 60s token expiration
- Session risk tracking & enhanced kill switch

### Phase 24: Docker Actions

**Goal:** Agent can control Docker container lifecycle.

**Deliverables:**
- DockerActionExecutor with start/stop/restart/inspect
- Container logs, network, and exec operations
- Tool registration and framework integration

### Phase 25: Host Actions

**Goal:** Agent can control systemd services and processes.

**Deliverables:**
- HostActionExecutor with systemd service methods
- ServiceWhitelist validation
- Process kill with SIGTERM → SIGKILL escalation
- PID validation

### Phase 26: Script Execution & Validation

**Goal:** Agent can generate and execute sandboxed scripts.

**Deliverables:**
- Multi-layer validation (syntax, secrets, dangerous commands)
- ScriptExecutor with sandbox Docker execution
- No network, 512MB RAM, 1 CPU, read-only FS
- Tool registration

## Superseded Work (Phases 27-29)

### Phase 27: Risk Classification (Not Started)

Would have classified actions by risk level (LOW/MEDIUM/HIGH/CRITICAL) with approval mode configurable per level.

**Why superseded:** v3.0 has no approval workflow — audit instead of gate.

### Phase 28: Agent Integration (Not Started)

Would have integrated script generation into agent diagnosis flow with iterative refinement.

**Why superseded:** v3.0 uses direct Claude tool calling — no special integration needed.

### Phase 29: Demo Scenarios (Not Started)

Would have validated infrastructure actions through container recovery and config repair demos.

**Why superseded:** v3.0 Phase 32 covers end-to-end validation with simpler architecture.

## Code Location

The v2.3 code (phases 23-26) remains in the codebase but is not used by v3.0:

- `packages/operator-core/src/operator_core/safety/` — Safety controls
- `packages/operator-core/src/operator_core/actions/docker_executor.py` — Docker executor
- `packages/operator-core/src/operator_core/actions/host_executor.py` — Host executor
- `packages/operator-core/src/operator_core/actions/script_executor.py` — Script executor
- `packages/operator-core/src/operator_core/actions/script_validator.py` — Script validation

---
*Archived: 2026-01-28*
